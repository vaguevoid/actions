# Void GitHub Actions

This public repository contains GitHub actions for use with the [Void](https://void.dev) game development platform

## Build

The following action can be used to build the web version of a Void game.

Assumptions:
  * Has a `build` script defined inside `package.json`
  * `build` script uses some combination of `vite build`

```yaml
  steps:
    - name: Build Web
      uses: vaguevoid/actions/build/web@alpha
      with:
        output: "release/web"  # output directory for bundled web game
        baseUrl: "./"          # ensure vite generates relative links
```

## Package

The following action can be used to package a Void game in Electron

Assumptions
  * Game was built using `build/web` action above

```yaml
  steps:
    - name: Package Windows (x64)
      uses: vaguevoid/actions/package/electron@alpha
      with:
        bundle: "release/web"       # path to your bundled web game (generated by build/web)
        releasePath: "release"      # path to generate packaged games within
        executable: "my-game"       # name (without extension) to use for generated executables
        platform: "win-32"          # which platform to target (win32 | linux | darwin)
        arch: "x64"                 # which architecture to target (x64 | arm64)
        electronVersion: "31.0.2"   # which version of electron to package 
```

## Deploy

The following action can be used to deploy a Void game to Steam

Assumptions
  * Game was built using `build/web` action above
  * Game was packaged using `package/electron` action above
  * A GitHub secret `STEAM_CONFIG_VDF` exists containing Steam user authorization

```yaml
  steps:
    - name: Deploy to Steam
      uses: vaguevoid/actions/deploy/steam@alpha
      with:
        releasePath:       "release"                       # path to packaged builds (generated by package/electron)
        executable:        "my-game"                       # name (without extension) used for generated executables
        username:          gordonja                        # Steam username
        configVdf:         ${{ secrets.STEAM_CONFIG_VDF }} # Saved Steam login session (see below)
        appId:             "xxxx"                          # your Steam Application ID
        windowsDepotId:    "xxxx"                          # the Steam Depot ID for your win32-x64 binaries (if any)
        macosDepotId:      "xxxx"                          # the Steam Depot ID for your darwin-x64 binaries (if any)
        linuxDepotId:      "xxxx"                          # the Steam Depot ID for your linux-x64 binaries (if any)
        buildDescription:  "latest beta test"              # (optional) build description
```

Use the `vaguevoid/actions/deploy/login` Docker image to generate a `STEAM_CONFIG_VDF` for your
Steam user. You may have to manually regenerate and upload a new secret every 30 days.

From your terminal:

```bash
> docker run -it vaguevoid/actions/deploy/steam/login [USERNAME]

Steam> Enter you password:
Steam> Enter your Steam Guard code:

> cat ./config.vdf    # copy the contents of this file to your `STEAM_CONFIG_VDF` GitHub secret
```


### Development

For developing these packages, you can use bun (or npm) as a task runner

```bash
> bun install
> bun run images   # build all docker images
```

Some of these GitHub actions expect to be mounted so that the CWD maps to the GitHub Actions
workspace folder on the host so that they can generate files and have them available to the
host (or subsequent actions). In order to test that behavior from your local machine you may
have to...
  * mount the cwd as a volume
  * pass any required environment variables

E.g.

```bash
> docker run -it -e [ENV] -v .:/workspace -w /workspace [IMAGE] [ARGS]
```
